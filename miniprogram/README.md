# 24点游戏 - 微信小程序版

这是24点游戏的微信小程序版本，基于原有的Web版本改造而来。

## 项目结构

```
miniprogram/
├── app.js              # 小程序入口文件
├── app.json            # 小程序配置文件
├── app.wxss            # 全局样式
├── pages/              # 页面目录
│   ├── index/          # 首页（启动页）
│   ├── lobby/          # 游戏大厅
│   ├── waiting/        # 等待室
│   └── game/           # 游戏页面
├── components/         # 组件目录（待开发）
├── utils/              # 工具类
│   └── calculator.js   # 24点计算器
├── services/           # 服务层
│   └── websocket.js    # WebSocket封装
└── images/             # 图片资源

```

## 主要改动

### 1. 架构改动
- React → 微信小程序原生框架
- Socket.io → 微信WebSocket API
- React Router → 小程序页面导航
- Framer Motion → 微信动画API

### 2. WebSocket适配
- 封装了WebSocket服务，适配Socket.io的事件模式
- 实现了自动重连机制
- 消息队列确保消息不丢失

### 3. 游戏功能
- 保留了核心游戏逻辑
- 计算器工具类完全复用
- 游戏规则和流程保持一致

### 4. UI适配
- 使用WXML/WXSS重构所有界面
- 保持了原有的设计风格
- 适配了小程序的交互方式

## 开发指南

### 1. 配置服务器地址
在 `app.js` 中修改WebSocket服务器地址：
```javascript
socketUrl: 'wss://your-server-domain.com'
```

### 2. 本地开发
1. 使用微信开发者工具打开 `miniprogram` 目录
2. 配置AppID（可以使用测试号）
3. 开启不校验域名选项进行本地调试

### 3. 服务器要求
- 服务器需要支持WebSocket协议
- 生产环境需要配置wss://（HTTPS）
- 需要在小程序后台配置socket合法域名

## 待完成功能

1. **动画效果**
   - 卡片发牌动画
   - 胜利/失败动画
   - 页面转场动画

2. **音效系统**
   - 背景音乐
   - 操作音效

3. **用户系统**
   - 微信登录集成
   - 用户数据持久化
   - 战绩统计

4. **社交功能**
   - 好友对战
   - 排行榜
   - 分享功能

5. **优化项**
   - 性能优化
   - 错误处理
   - 断线重连优化

## 注意事项

1. **网络请求限制**
   - 小程序对WebSocket连接数有限制（最多5个）
   - 需要在小程序后台配置合法域名

2. **文件大小限制**
   - 单个分包不超过2M
   - 整个小程序不超过20M

3. **API差异**
   - 注意微信小程序API与Web API的差异
   - 某些Web特性在小程序中不可用

## 发布流程

1. 完成开发和测试
2. 在微信公众平台注册小程序
3. 配置服务器域名
4. 上传代码并提交审核
5. 审核通过后发布上线